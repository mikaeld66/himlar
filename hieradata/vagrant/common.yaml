---
location_environment: dev
location_description: Local development environment using vagrant

#
# Default interfaces
#
mgmt_interface:      'eth0'
mgmt_address:        "%{ipaddress_eth0}"

#
# Openstack services
#
# These defaults will only work when all services are installed on the
# same box - they need to be overridden per location
#
service__address__mysql:             "10.0.3.14"
service__address__rabbitmq:          "10.0.3.14"
service__address__keystone:          "10.0.3.14"
service__address__glance_registry:   "10.0.3.14"
service__address__glance_api:        "10.0.3.14"
service__address__nova_api:          "10.0.3.14"
service__address__nova_api_metadata: "10.0.3.14"
service__address__neutron_server:    "10.0.3.14"
service__address__consoleproxy:      "10.0.3.14"

#
# Accounts in vagrant
#  - vagrant user as member of weel and users group
#  - add all admin ssh keys to iaas user
#
accounts::accounts:
  'vagrant':
    ensure: present
    groups:
      - 'wheel'
      - 'users'
  'iaas':
    ensure: present
    authorized_keys:
      - '@admins'
    groups:
      - 'wheel'
      - 'users'

sudo::configs:
  requiretty:
    priority: 5
    content: 'Defaults:vagrant !requiretty'
  vagrant:
    priority: 10
    content: 'vagrant ALL=(ALL) NOPASSWD:ALL'

profile::network::services::dns_options:
  CNAME:
    default:
      ttl: 3600
      keyfile: "/etc/rndc.key"
      server: '10.0.3.5'
  A:
    default:
      ttl: 86400
      keyfile: "/etc/rndc.key"
      server: '10.0.3.5'

profile::network::services::dns_records:
  CNAME:
    'puppet.himlar.local':                 'vagrant-foreman-box.himlar.local'
    'admin.himlar.local':                  'vagrant-foreman-box.himlar.local'
    'repo.himlar.local':                   'vagrant-foreman-box.himlar.local'
  A:
    'vagrant-foreman-box.himlar.local':      '10.0.3.5'
    'vagrant-compute-box.himlar.local':      '10.0.3.11'
    'vagrant-compute-pxe.himlar.local':      '10.0.3.111'
    'vagrant-controller-box.himlar.local':   '10.0.3.12'
    'vagrant-controller-pxe.himlar.local':   '10.0.3.112'
    'vagrant-login-box.himlar.local':        '10.0.3.13'
    'vagrant-login-pxe.himlar.local':        '10.0.3.113'
    'vagrant-master-box.himlar.local':       '10.0.3.14'
    'vagrant-master-pxe.himlar.local':       '10.0.3.114'

bmcremote::hostdata:
  osl-compute-01:
    ip: 129.240.224.80
    settings:
      set_1:
        order: 01
        check:
          idrac.ipv4.address: 129.240.224.80
        set:
          idrac.ipv4.enable: Enabled
          idrac.ipv4.dhcpenable: Disabled
          idrac.ipv4.address: 1.2.3.4
          idrac.ipv4.gateway: 1.2.3.4
          idrac.ipv4.netmask: 1.2.3.4
          idrac.ipv6.enable: Disabled
        exec:
          {}
      set_2:
        order: 02
        check:
          bios.biosbootsettings.bootmode: Bios
          bios.biosbootsettings.bootseq: NIC.Integrated.1-3-1,HardDisk.List.1-1
        set:
          bios.biosbootsettings.bootmode: Bios
          bios.biosbootsettings.bootseq: NIC.Integrated.1-3-1,HardDisk.List.1-1
        exec:
          - jobqueue create BIOS.Setup.1-1


